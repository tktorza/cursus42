{% extends 'ClabBoardBundle:Base:base.html.twig' %}

{% block bodyClass %}singlenav{% endblock %}
{% block navContent %}{% endblock %}

{% block body %}
<div class="container">
    {% include 'ClabBoardBundle:Onboard:Custom/breadcrumbs.html.twig' with { step: 'social' } %}

    <br><br>
    <section class="panel">
        <div class="panel-body">
            <h2>8. Votre espace social</h2>
            <hr>

            <h4>1. Reliez la page Facebook de votre restaurant pour pouvoir poster dessus en 1 clic et y afficher ensuite votre menu et l'espace de commande en ligne.</h4>
            <div class="row">
                <div class="col-md-6">
                    <section class="panel">
                        <header class="panel-heading"><i class="fa fa-facebook icon-left"></i>Facebook</header>
                        <div class="panel-body">
                            {% if proxy.socialProfile.facebookAccessToken %}
                                {% set data = proxy.socialProfile.facebookDataDecoded %}
                                <div class="media">
                                    {% if proxy.facebookPage %}
                                    <div class="pull-left"><img src="https://graph.facebook.com/{{ proxy.facebookPage.facebookId }}/picture?width=40&height=40" class="img-circle"></div>
                                    {% endif %}
                                    <div class="media-body">
                                        <p>Connecté en tant que {{ data.first_name }} {{ data.last_name }}</p>
                                        {% if proxy.facebookPage %}
                                            <p>Vous publiez sur la page <strong>{{ proxy.facebookPage.name }}</strong></p>
                                        {% else %}
                                            <p>Vous n'avez pas encore relié de page.</p>
                                        {% endif %}

                                        {% if proxy.facebookPage %}
                                            {% if proxy.isMobile %} 
                                            <hr>
                                                {% if fbMenu %}
                                                <small><i class="fa fa-circle icon-success icon-left"></i>L'onglet menu est installé</small>
                                                {% else %}
                                                <small><i class="fa fa-circle icon-danger icon-left"></i>L'onglet menu ne semble pas encore installé</small>
                                                {% endif %}
                                                <br><br>
                                                <a class="btn btn-facebook" href="{{ path('board_social_add_page_tab', { contextPk: contextPk, tab: 'ttt_menu', backUrl: url('board_onboard_custom_social', { slug: proxy.slug })|url_encode }) }}"><i class="fa fa-facebook icon-left"></i>Ajouter mon menu sur Facebook</a>

                                                <br><br><br>

                                                {% if fbPlanning %}
                                                <small><i class="fa fa-circle icon-success icon-left"></i>L'onglet itinéraire est installé</small>
                                                {% else %}
                                                <small><i class="fa fa-circle icon-danger icon-left"></i>L'onglet itinéraire ne semble pas encore installé</small>
                                                {% endif %}
                                                <br><br>
                                                <a class="btn btn-facebook" href="{{ path('board_social_add_page_tab', { contextPk: contextPk, tab: 'ttt_planning', backUrl: url('board_onboard_custom_social', { slug: proxy.slug })|url_encode }) }}"><i class="fa fa-facebook icon-left"></i>Ajouter mon itinéraire sur Facebook</a>
                                            {% endif %}
                                        {% endif %}
                                    </div>
                                </div>
                            {% else %}
                                <p>
                                    1/ Cliquez sur "Se connecter avec Facebook"<br>
                                    2/ Cliquez sur OK pour chaque fenêtre sur Facebook (3 fois)<br>
                                    3/ Choisissez la page de votre restaurant<br>
                                    <br>
                                    <small>Nous ne posterons aucun message sur votre profil Facebook personnel ni sans votre autorisation.</small>
                                </p>
                            {% endif %}
                        </div>
                        <div class="panel-footer">
                            <div class="pull-right">
                                {% if proxy.socialProfile.facebookAccessToken %}
                                    <a class="btn btn-default confirmModal" href="#" data-route="{{ path('board_social_configuration_remove', { contextPk: contextPk, type: 'facebook', backUrl: url('board_onboard_custom_social', { slug: proxy.slug }) }) }}">{{ 'pro.communication.conf.connect.logout'|trans }}</a>
                                    <a href="{{ path('board_social_configuration_choose_page', { contextPk: contextPk, backUrl: url('board_onboard_custom_social', { slug: proxy.slug }) }) }}" data-target="ajaxModal" class="btn btn-primary choosePage">Choisir votre page</a>
                                {% else %}
                                    <a class="btn btn-facebook" href="{{ path('opauth', { redirect: path('board_onboard_custom_social', { slug: proxy.slug, trigger: 'page' })|url_encode, type: 'facebook', socialProfileId: proxy.socialProfile.id }) }}"><i class="fa fa-facebook icon-left"></i>{{ 'pro.communication.conf.connect.facebookButton'|trans }}</a>
                                {% endif %}
                            </div>
                            <div class="clear"></div>
                        </div>
                    </section>            
                </div>
            </div>

            <h4>2. Reliez le fil Twitter de votre restaurant pour pouvoir poster dessus en 1 clic.</h4>
            <div class="row">
                <div class="col-md-6">
                    <section class="panel">
                        <header class="panel-heading"><i class="fa fa-twitter icon-left"></i>Twitter</header>
                        <div class="panel-body">
                            {% if proxy.socialProfile.twitterAccessToken %}
                                {% set data = proxy.socialProfile.twitterDataDecoded %}
                                <div class="media">
                                    <div class="pull-left"><img src="{{ data.profile_image_url }}" class="img-circle"></div>
                                    <div class="media-body">
                                        <p>{{ 'pro.communication.conf.connect.connectedAs'|trans }} {{ data.name }} : @{{ data.screen_name }}</p>
                                    </div>
                                </div>
                            {% else %}
                                <p>
                                    1/ Cliquez sur "Se connecter avec Twitter"<br>
                                    2/ Cliquez sur OK sur la fenêtre sur Twitter<br>
                                    <br>
                                    <small>Nous ne posterons aucun message sur votre fil Twitter sans votre autorisation.</small>
                                </p>
                            {% endif %}
                        </div>
                        <div class="panel-footer">
                            <div class="pull-right">
                                {% if proxy.socialProfile.twitterAccessToken %}
                                    <a class="btn btn-default confirmModal" href="#" data-route="{{ path('board_social_configuration_remove', { contextPk: contextPk, type: 'twitter', backUrl: url('board_onboard_custom_social', { slug: proxy.slug }) }) }}">{{ 'pro.communication.conf.connect.logout'|trans }}</a>
                                {% else %}
                                    <a class="btn btn-twitter" href="{{ path('opauth', { redirect: path('board_onboard_custom_social', { slug: proxy.slug }), type: 'twitter', socialProfileId: proxy.socialProfile.id }) }}"><i class="fa fa-twitter icon-left"></i>{{ 'pro.communication.conf.connect.twitterButton'|trans }}</a>
                                {% endif %}
                            </div>
                            <div class="clear"></div>
                        </div>
                    </section>
                </div>
            </div>

            <hr>
            <div class="row">
                <div class="col-md-4">
                    <a class="btn btn-default btn-lg btn-block" href="{{ path('board_onboard_custom_terms', { slug: proxy.slug }) }}"><i class="fa fa-arrow-circle-left icon-left"></i>Précédent</a>
                </div>

                <div class="col-md-8">
                    <a href="{{ path('board_onboard_custom_final', { slug: proxy.slug }) }}" class="btn btn-primary btn-lg btn-block">Suivant<i class="fa fa-arrow-circle-right icon-right"></i></a>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block javascripts %}
<script type="text/javascript">
    {% if trigger is defined and trigger == 'page' %}
        $('.choosePage').click();
    {% endif %}
</script>
{% endblock %}